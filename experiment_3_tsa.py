# -*- coding: utf-8 -*-
"""Experiment 3 TSA

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/15yPYAiacPtmwDBJEod2AERRz-Y7-KP8r
"""

!pip install statsmodels

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from statsmodels.tsa.ar_model import AutoReg

df = pd.read_csv('opsd_germany_daily.csv')
df.head()

df['Consumption'].plot()

from statsmodels.tsa.stattools import adfuller

df_stationaryTest = adfuller(df['Consumption'], autolag='AIC')

print('P-value', df_stationaryTest[1])

from statsmodels.graphics.tsaplots import plot_pacf
pacf = plot_pacf(df['Consumption'], lags = 25)

train_data = df['Consumption'][:len(df)-100]
test_data = df['Consumption'][len(df)-100 :]

ar_model = AutoReg(train_data, lags = 8).fit()
print(ar_model.summary())

pred = ar_model.predict(start = len(train_data), end= (len(df)-1), dynamic= False)
plt.plot(pred)
plt.plot(test_data, color = 'red')